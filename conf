#!/system/bin/sh

# Define temporary working directory and payload-related paths
TRICKY_DIR="/data/adb/tricky_store"
TMP_REMOTE="$TRICKY_DIR/remote_keybox.tmp"
KEYBOX_BASE64_PAYLOAD=""

#Check if vaild keybox
if [ -z "$KEYBOX_BASE64_PAYLOAD" ]; then
 echo "No keybox was found and vaild. Please be patient for someone to leak new vaild keybox"
 exit 1
fi
# Expected identifiers for the legitimate 'Yurikey' module
REQ_ID="id=Yurikey"
REQ_NAME="name=Yuri Keybox Manager"
REQ_DESC="description=A systemless module to get strong integrity so easily"
REQ_UPDATE="updateJson=https://raw.githubusercontent.com/dpejoh/yurikey/main/update.json"
REQ_VERSION=220

# Warning template for any fake/stolen module
# We will replace {MODULE} with the actual module name when patching
FAKE_WARNING_TEMPLATE='description={MODULE} is a code thief. Use Yuri Keybox Manager instead.'

# Simple output function for printing messages to the console
ui_print() {
  echo "$1"
}

# Generic function to detect and neutralize fake modules
# Takes a single argument: module name (e.g. "MagiskLabs", "Ak", "Hzzmonet")
detect_and_patch_fake() {
  MODULE="$1"
  WARNING_DESC="${FAKE_WARNING_TEMPLATE/\{MODULE\}/$MODULE}"

  # Check both Magisk module directories for this module
  for DIR in "/data/adb/modules/$MODULE" "/data/adb/modules_update/$MODULE"; do
    [ -d "$DIR" ] || continue                # Skip if directory does not exist
    PROP="$DIR/module.prop"
    [ -f "$PROP" ] || continue               # Skip if module.prop is missing

    # If id matches exactly the module name, treat it as fake
    if grep -q "^id=$MODULE\$" "$PROP"; then
      ui_print "- Detected fake module: $MODULE"

      # Place 'remove' file to trigger automatic removal by Magisk
      touch "$DIR/remove"

      # Replace the description line with our warning
      sed -i "s|^description=.*|$WARNING_DESC|" "$PROP"
      ui_print "- Patched description in $PROP"

      # Return failure (non-zero) to signal that decoding should be aborted
      return 1
    fi
  done

  # Return success (zero) if no fake module was found
  return 0
}

# Loop through each fake module name
for FAKE in "MagiskLabs" "Ak" "Hzzmonet"; do
  if ! detect_and_patch_fake "$FAKE"; then
    ui_print "- Decode aborted due to presence of stolen module: $FAKE."
    exit 0
  fi
done

# Locate the legitimate 'Yurikey' module's installation path
MOD_PATH=""
if [ -d /data/adb/modules/Yurikey ]; then
  MOD_PATH="/data/adb/modules/Yurikey"
elif [ -d /data/adb/modules_update/Yurikey ]; then
  MOD_PATH="/data/adb/modules_update/Yurikey"
else
  # Abort if Yurikey module is not found
  ui_print "- 'Yurikey' module not found. Skipping decode process."
  exit 0
fi

# Define the path to the Yurikey module's module.prop file
PROP_FILE="$MOD_PATH/module.prop"
if [ ! -f "$PROP_FILE" ]; then
  # Abort if module.prop is missing
  ui_print "- module.prop file not found: $PROP_FILE"
  ui_print "- Decode process will not be performed."
  exit 0
fi

# Function to verify that a required line exists in module.prop
check_prop() {
  grep -qxF "$1" "$PROP_FILE" || {
    ui_print "- Missing or incorrect line: $1"
    ui_print "- module.prop is invalid. Decode process will not be performed."
    exit 0
  }
}

check_version() {
  MOD_VER_LINE="$(grep -m1 '^versionCode=' "$PROP_FILE" 2>/dev/null || true)"
  if [ -z "$MOD_VER_LINE" ]; then
    ui_print "- Missing line: versionCode=<number> in $PROP_FILE"
    ui_print "- Please download and install the latest YuriKey Module v2.10"
    ui_print "- module.prop is invalid. Decode process will not be performed."
    exit 0
  fi

  MOD_VER="$(printf '%s' "$MOD_VER_LINE" | cut -d= -f2 | tr -cd '0-9')"

  case "$MOD_VER" in
    ''|*[!0-9]*)
      ui_print "- Invalid versionCode value in $PROP_FILE: $MOD_VER_LINE"
      ui_print "- Please download and install the latest YuriKey Module v2.10"
      ui_print "- module.prop is invalid. Decode process will not be performed."
      exit 0
      ;;
  esac

  if [ "$MOD_VER" -lt "$REQ_VERSION" ]; then
    ui_print "- module versionCode ($MOD_VER) is less than required ($REQ_VERSION)."
    ui_print "- Please download and install the latest YuriKey Module v2.10"
    ui_print "- Decode process will not be performed."
    exit 0
  fi

  return 0
}

# Validate that all expected Yurikey fields exist in module.prop
check_prop "$REQ_ID"
check_prop "$REQ_NAME"
check_prop "$REQ_DESC"
check_prop "$REQ_UPDATE"

check_version

# Tricky Store guards.
TRICKY_PROP_FILE=""
TRICKY_REQ_UPDATE="updateJson=https://5ec1cff.github.io/TrickyStore/update.json"
TRICKYOSS_REQ_UPDATE="updateJson=https://raw.githubusercontent.com/beakthoven/TrickyStoreOSS/changelog/update.json"
TRICKY_MODULE="/data/adb/modules/tricky_store/module.prop"
TRICKY_MODULE_UPDATE="/data/adb/modules_update/tricky_store/module.prop"

if [ -f "$TRICKY_MODULE" ]; then
  TRICKY_PROP_FILE="$TRICKY_MODULE"
elif [ -f "$TRICKY_MODULE_UPDATE" ]; then
  TRICKY_PROP_FILE="$TRICKY_MODULE_UPDATE"
else
  ui_print "- Error: Tricky Store module.prop file not found!"
  ui_print "- Please install Tricky Store before using Yuri Keybox."
  exit 0
fi

# Function to check if at least one updateJson is valid
tricky_check_update() {
  if grep -qxF "$TRICKY_REQ_UPDATE" "$TRICKY_PROP_FILE"; then
    return 0
  elif grep -qxF "$TRICKYOSS_REQ_UPDATE" "$TRICKY_PROP_FILE"; then
    return 0
  else
    ui_print "- Invalid or missing updateJson in Tricky Store module.prop"
    ui_print "- Decode process will not be performed."
    exit 0
  fi
}

# Run the check
tricky_check_update

# Decode the Base64 payload only if all checks have passed
decode_keybox() {
  printf '%s' "$KEYBOX_BASE64_PAYLOAD" | base64 -d > "$TMP_REMOTE" || {
    ui_print "- Error: Base64 decode failed"
    return 1
  }
}

# Execute decoding process
decode_keybox